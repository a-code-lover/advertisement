### Lucene系

Apache Lucene, elestic search, solr

### Sphinx C++高性能引擎

[对比](http://youzhixueyuan.com/comparison-of-open-source-search-engine-selection.html)

### 层次化的索引结构

投放模型的主要实体是广告主（Advertiser）、推广计划（Campaign）、广告组（Adgroup）、创意（Creative）等。其中：

- 广告主和推广计划：定义用于控制广告投放的各类状态字段。
- 广告组：描述广告相关属性，例如竞价关键词、最高出价等。
- 创意：与广告的呈现、点击等相关的字段，如标题、创意地址、点击地址等。

一般地，广告检索、排序等均基于广告组粒度，广告的倒排索引也是建立在广告组层面。借鉴关系数据库的概念，可以把广告组作为正排主表（即一个Adgroup是一个doc），并对其建立倒排索引；把广告主、推广计划等作为辅表。主表与辅表之间通过外键关联。

### 实时化的索引更新

特别是与上下线状态相关的属性字段，需要在若干毫秒内完成更新，对实时性有较高要求。  
用于召回条件的索引字段，其更新可以滞后一些，如在几秒钟之内完成更新。采用分而治之的策  略，可极大降低系统复杂度。

+ 属性字段的更新：直接修改正排表的字段值，可以保证毫秒级完成。
+ 索引字段的更新：涉及更新流实时计算、倒排索引等的处理过程，只需保证秒级完成。

此外，通过定期切换全量索引并追加增量索引，由索引快照确保数据的正确性。

### 核心逻辑

matching(召回，粗排)--ranking(精排)--topk

### 高效优化

在“读多写少”的业务场景，需要优先保证“读”的性能。检索是内存查找过程，属于计算密集型服务，为保证CPU的高并发，一般设计为无锁结构。可采用“一写多读”和延迟删除等技术，确保系统高效稳定运转。此外，巧妙利用数组结构，也进一步优化了读取性能。

为提升系统的吞吐量，多个模块实现服务端异步化。

工程：可行性，稳定性，可扩展性，高性能
采用C++11作为开发语言，严格遵守《Geogle C++ Style》
[推荐和广告在召回候选集时的差别？](https://www.zhihu.com/question/56781383)